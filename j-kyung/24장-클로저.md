# 24장-클로저
- `함수`와 그 함수가 선언된 `렉시컬 환경`과의 조합

## 24.1 렉시컬 스코프
- js엔진은 함수 어디서 호출? X, 함수 어디서 정의? O -> 상위 스코프 결정
    - => 렉시컬 스코프(정적 스코프)
- 스코프의 실체 = 실행 컨텍스트의 렉시컬 환경
    - 외부 렉시컬 환경에 대한 참조를 통해 상위 렉시컬 환경과 연결 -> 스코프 체인
- 렉시컬 환경의 `외부 렉시컬 환경에 대한 참조`에 저장할 참조값, 상위 스코프에 대한 참조는 함수 정의가 평가되는 시점에 정의된 환경에 의해 결정

## 24.2 함수 객체의 내부 슬롯
- 자신이 정리된 환경, 상위 스코프 참조를 저장 -> 현재 실행중인 실행 컨텍스트의 렉시컬 환경을 가리킴
### 함수 코드 평가 순서
1. 함수 실행 컨텍스트 생성
2. 함수 렉시컬 환경 생성  
    2.1. 함수 환경 레코드 생성  
    2.2. this 바인딩  
    2.3. 외부 렉시컬 환경에 대한 참조 결정

## 24.3 클로저와 렉시컬 환경
- 외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 이미 생명주기가 종료한 외부 함수의 변수 참조 가능 -> 중첩 함수를 `클로저`라고 부름
- js의 모든 함수는 자신의 상위 스코프 기억
    - 함수를 어디서 호출하든 함수는 언제나 자신이 기억하는 상위 스코프의 식별자를 참조할 수 있음, 식별자에 바인딩 된 값 변경할 수 있음
- [[Environment]] 내부 슬롯에 저장된 상위 스코프는 함수가 존재하는 한 유지됨
- 함수의 생명주기가 종료되면 실행 컨텍스트는 스택에서 제거되지만, 렉시컬 환경까지 소멸하는 것은 X
    - 중첩 함수의 [[Environment]] 내부 슬롯에 의해 참조되고 있음
        - 가비지 컬렉션의 대상이 X (가비지 컬렉션은 누군가 참조하고 있는 메모리 공간은 건들지 않음)
- 이론적 모든 함수는 클로저
    - but, 상위 스코프의 어떤 식별자도 참조하지 않는 함수는 클로저가 아님
- 중첩 함수가 상위 스코프의 식별자를 참조, 중첩 함수가 외부 함수보다 더 오래 유지되는 경우에 한정
- 상위 스코프의 식별자 중 클로저가 참조하고 있는 식별자만 기억
    - = 자유 변수(free variable)
- 자유 변수에 묶여있는 함수

## 24.4 클로저의 활용
- 상태를 안전하게 변경, 유지(상태를 안전하게 은닉, 특정 함수에게만 상태 변경 허용)

## 25.5 캡슐화와 정보 은닉
- 캡슐화 : 객체의 상태를 나타내는 프로퍼티와 프로퍼티를 참조하고 조작할 수 있는 동작인 메서드를 하나로 묶음
- 정보 은닉 : 객체의 특정 프로퍼티나 메서드를 감출 목적으로 사용
    - 외부 공개하지 않는 구현의 일부를 공개되지 않도록 감추어 적절하지 않은 접근으로부터 객체의 상태 변경 방지 -> 정보 보호, 객체간의 상호 의존성(결합도) 낮춤
- js는 public, private, protected 같은 접근 제한자가 제공 X
- js의 모든 프로퍼티와 메서드는 기본적으로 외부에 공개 (= public)